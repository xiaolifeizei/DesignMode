## 工厂模式（Factory）

工厂模式（Factory）

### 一、说明

工厂模式（Factory）是最常用的设计模式之一。属于创建型模式，它提供了一种创建对象的最佳方式。在工厂模式中，我们在创建对象时不会对客户端暴露创建逻辑。工厂模式一般分为三种：简单工厂模式（Simple Factory）、工厂方法模式（Factory Method）、抽象工厂模式。

创建型模式对类的实例化过程进行了抽象，能够将软件模块中对象的创建和对象的使用分离。为了使软件的结构更加清晰，外界对于这些对象只需要知道它们共同的接口，而不清楚其具体的实现细节，使整个系统的设计更加符合单一职责原则。

工厂模式是创建型模式中比较重要的。工厂模式的主要功能就是帮助我们实例化对象。之所以名字中包含工厂模式四个字，是因为对象的实例化过程是通过工厂实现的，是用工厂代替 new 操作的。

### 二、角色

- 简单工厂模式

  - 简单工厂（Simple Factory）角色：

    负责创建所有实例的内部逻辑，工厂类的方法可以被外界直接调用，创建所需的产品对象。

  - 抽象产品（Abstract Product）角色

    大多是对象的父类或接口，负责描述所有实例共有的公共接口。

  - 具体产品（Concrete Product）角色

    简单共厂模式的创建目标

- 工厂方法模式

  - 抽象工厂（Abstract Factory）角色：

    定义了创建抽象产品的方法，创建对象的工厂类都必须实现这个接口

  - 具体工厂（Concrete Factory）角色：

    实现抽象工厂接口的具体工厂类，负责生产具体的产品

  - 抽象产品（Abstract Product）角色

  - 具体产品（Concrete Product）角色

### 三、总结

工厂方法模式和简单工厂模式虽然都是通过工厂来创建对象，他们之间最大的不同是工厂方法模式在设计上完全完全符合“开闭原则”。

使用场景：

1) 在任何需要生成复杂对象的地方，都可以使用工厂方法模式。有一点需要注意的地方就是复杂对象适合使用工厂模式，而简单对象，特别是只需要通过 new 就可以完成创建的对象，无需使用工厂模式。如果使用工厂模式，就需要引入一个工厂类，会增加系统的复杂度。

2) 工厂模式是一种典型的解耦模式，当调用者自己组装产品需要增加依赖关系时，可以使用工厂模式，会大大降低对象之间的耦合度。

3) 当需要系统有比较好的扩展性时，可以考虑工厂模式，不同的产品用不同的实现工厂来组装。
4) 一个类不知道它所需要的对象的类，在工厂方法模式中，客户端不需要知道具体产品类的类名，只需要知道所对应的工厂即可，具体的产品对象由具体工厂类创建；客户端需要知道创建具体产品的工厂类。
5) 一个类通过其子类来指定创建哪个对象，在工厂方法模式中，对于抽象工厂类只需要提供一个创建产品的接口，而由其子类来确定具体要创建的对象，利用面向对象的多态性和里氏代换原则，在程序运行时，子类对象将覆盖父类对象，从而使得系统更容易扩展。
6) 将创建对象的任务委托给多个工厂子类中的某一个，客户端在使用时可以无须关心是哪一个工厂子类创建产品子类，需要时再动态指定，可将具体工厂类的类名存储在配置文件或数据库中。

使用案例：

- 日志记录器：记录可能记录到本地硬盘、系统事件、远程服务器等，用户可以选择记录日志到什么地方。

- 数据库访问：当用户不知道最后系统采用哪一类数据库，以及数据库可能有变化时。

- 连接服务器：需要三个协议，如"POP3"、"IMAP"、"HTTP"，可以把这三个作为产品类，共同实现一个接口。
